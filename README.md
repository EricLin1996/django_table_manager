# Django è¡¨æ ¼ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºDjangoçš„é¡¹ç›®ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºç®¡ç†å­é¡¹ç›®è¯¦ç»†ä¿¡æ¯ï¼Œæ”¯æŒç”¨æˆ·æƒé™ç®¡ç†å’ŒéªŒè¯ç ç™»å½•ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ” ç”¨æˆ·è®¤è¯
- ç”¨æˆ·åå¯†ç ç™»å½•
- ç®€å•å­—æ¯éªŒè¯ç ï¼ˆ4ä½å¤§å†™å­—æ¯ï¼‰
- ç”¨æˆ·æƒé™åˆ†çº§ï¼ˆç®¡ç†å‘˜/æ™®é€šç”¨æˆ·ï¼‰
- ä¼šè¯ç®¡ç†

### ğŸ‘¥ ç”¨æˆ·ç®¡ç†
- **ç®¡ç†å‘˜æƒé™**ï¼š
  - åˆ›å»ºæ–°ç”¨æˆ·
  - è®¾ç½®ç”¨æˆ·æƒé™çº§åˆ«
  - æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨
  - æŸ¥çœ‹å’Œä¿®æ”¹é¡¹ç›®æŠ¥è¡¨
- **æ™®é€šç”¨æˆ·æƒé™**ï¼š
  - ä»…å¯æŸ¥çœ‹å’Œä¿®æ”¹é¡¹ç›®æŠ¥è¡¨
  - æ— æ³•åˆ›å»ºç”¨æˆ·

### ğŸ“Š é¡¹ç›®ç®¡ç†
- å­é¡¹ç›®è¯¦ç»†ä¿¡æ¯è¡¨ç®¡ç†
- å­—æ®µåˆ†ç±»ï¼š
  - **åªè¯»å­—æ®µ**ï¼šid, parent_id, å¤‡æ¡ˆé¡¹ç›®ä¸»é¡¹ç›®, ä¸»é¡¹ç›®åœ°å€, å­é¡¹ç›®, æ•´æ”¹å®Œæˆæƒ…å†µæ˜ç»†, å·¡æŸ¥æ—¥æœŸæ˜ç»†
  - **å¯ä¿®æ”¹å­—æ®µ**ï¼šé¡¹ç›®ç¼–å·, æ—¥æœŸ, å·¥ç¨‹æœŸé™, å¼€å·¥æ—¥æœŸ, ç«£å·¥æ—¥æœŸ, åœ°å€, å»ºè®¾å•ä½, è”ç³»äºº, ç”µè¯, æ–½å·¥å•ä½, æ–½å·¥å•ä½è”ç³»äºº, ä¸šä¸», é¢ç§¯, å»ºå®‰é€ ä»·, ç°åœºå¼€å•è®°å½•æ˜ç»†, å¤‡æ³¨
- é¡¹ç›®æœç´¢åŠŸèƒ½
- åˆ†é¡µæ˜¾ç¤º
- æ•°æ®ä¿æŠ¤ï¼ˆç”¨æˆ·æ— æ³•å¢åŠ æˆ–åˆ é™¤è®°å½•ï¼‰

### ğŸ¨ ç”¨æˆ·ç•Œé¢
- ç°ä»£åŒ–Bootstrap 5è®¾è®¡
- å“åº”å¼å¸ƒå±€
- å‹å¥½çš„ç”¨æˆ·ä½“éªŒ
- ä¸­æ–‡ç•Œé¢

## æŠ€æœ¯æ ˆ

- **åç«¯**ï¼šPython 3.8+ / Django 4.2
- **æ•°æ®åº“**ï¼šMySQL 8.0+
- **å‰ç«¯**ï¼šBootstrap 5, HTML5, CSS3, JavaScript
- **å…¶ä»–**ï¼šPillow (éªŒè¯ç ç”Ÿæˆ), crispy-forms (è¡¨å•ç¾åŒ–)

## å®‰è£…éƒ¨ç½²

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone <your-repo-url>
cd django_table_manager

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. æ•°æ®åº“é…ç½®

ç¡®ä¿MySQLæœåŠ¡å·²å¯åŠ¨ï¼Œç„¶ååˆ›å»ºæ•°æ®åº“ï¼š

```sql
CREATE DATABASE table_manager CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

ä¿®æ”¹ `table_manager/settings.py` ä¸­çš„æ•°æ®åº“é…ç½®ï¼š

```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'table_manager',
        'USER': 'your_username',        # ä¿®æ”¹ä¸ºæ‚¨çš„MySQLç”¨æˆ·å
        'PASSWORD': 'your_password',    # ä¿®æ”¹ä¸ºæ‚¨çš„MySQLå¯†ç 
        'HOST': 'localhost',
        'PORT': '3306',
        'OPTIONS': {
            'charset': 'utf8mb4',
        }
    }
}
```

### 3. æ•°æ®åº“è¿ç§»

```bash
# åˆ›å»ºè¿ç§»æ–‡ä»¶
python manage.py makemigrations

# æ‰§è¡Œè¿ç§»
python manage.py migrate

# åˆ›å»ºè¶…çº§ç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰
python manage.py createsuperuser
```

### 4. åˆ›å»ºç”¨æˆ·é…ç½®æ–‡ä»¶

åˆ›å»ºè¶…çº§ç”¨æˆ·åï¼Œéœ€è¦ä¸ºå…¶åˆ›å»ºUserProfileï¼š

```bash
python manage.py shell
```

åœ¨Shellä¸­æ‰§è¡Œï¼š

```python
from django.contrib.auth.models import User
from projects.models import UserProfile

# ä¸ºè¶…çº§ç”¨æˆ·åˆ›å»ºç®¡ç†å‘˜é…ç½®æ–‡ä»¶
admin_user = User.objects.get(is_superuser=True)
UserProfile.objects.create(user=admin_user, is_admin=True)
```

### 5. è¿è¡ŒæœåŠ¡

```bash
python manage.py runserver
```

è®¿é—® `http://127.0.0.1:8000/` å³å¯ä½¿ç”¨ç³»ç»Ÿã€‚

## ä½¿ç”¨è¯´æ˜

### åˆæ¬¡ä½¿ç”¨

1. ä½¿ç”¨åˆ›å»ºçš„è¶…çº§ç”¨æˆ·è´¦å·ç™»å½•
2. è¿›å…¥"ç”¨æˆ·ç®¡ç†"åˆ›å»ºæ™®é€šç”¨æˆ·
3. åœ¨Djangoç®¡ç†åå° (`/admin/`) æ·»åŠ é¡¹ç›®æ•°æ®
4. æ™®é€šç”¨æˆ·ç™»å½•åå¯æŸ¥çœ‹å’Œç¼–è¾‘é¡¹ç›®ä¿¡æ¯

### ç”¨æˆ·æ“ä½œæµç¨‹

1. **ç™»å½•**ï¼šè¾“å…¥ç”¨æˆ·åã€å¯†ç å’ŒéªŒè¯ç 
2. **æŸ¥çœ‹é¡¹ç›®**ï¼šæµè§ˆå­é¡¹ç›®è¯¦ç»†ä¿¡æ¯åˆ—è¡¨
3. **æœç´¢é¡¹ç›®**ï¼šä½¿ç”¨æœç´¢åŠŸèƒ½å¿«é€Ÿå®šä½é¡¹ç›®
4. **ç¼–è¾‘é¡¹ç›®**ï¼šç‚¹å‡»ç¼–è¾‘æŒ‰é’®ä¿®æ”¹å¯ç¼–è¾‘å­—æ®µ
5. **ç”¨æˆ·ç®¡ç†**ï¼ˆä»…ç®¡ç†å‘˜ï¼‰ï¼šåˆ›å»ºå’Œç®¡ç†ç³»ç»Ÿç”¨æˆ·

## æ•°æ®æ¨¡å‹

### SubProject (å­é¡¹ç›®è¯¦ç»†ä¿¡æ¯è¡¨)

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å¯ç¼–è¾‘ |
|--------|------|------|---------|
| id | AutoField | ä¸»é”® | âŒ |
| parent_id | CharField | çˆ¶é¡¹ç›®ID | âŒ |
| main_project | CharField | å¤‡æ¡ˆé¡¹ç›®ä¸»é¡¹ç›® | âŒ |
| main_project_address | CharField | ä¸»é¡¹ç›®åœ°å€ | âŒ |
| sub_project | CharField | å­é¡¹ç›® | âŒ |
| rectification_details | TextField | æ•´æ”¹å®Œæˆæƒ…å†µæ˜ç»† | âŒ |
| inspection_details | TextField | å·¡æŸ¥æ—¥æœŸæ˜ç»† | âŒ |
| project_number | CharField | é¡¹ç›®ç¼–å· | âœ… |
| date | DateField | æ—¥æœŸ | âœ… |
| construction_period | CharField | å·¥ç¨‹æœŸé™ | âœ… |
| start_date | DateField | å¼€å·¥æ—¥æœŸ | âœ… |
| completion_date | DateField | ç«£å·¥æ—¥æœŸ | âœ… |
| address | CharField | åœ°å€ | âœ… |
| construction_unit | CharField | å»ºè®¾å•ä½ | âœ… |
| contact_person | CharField | è”ç³»äºº | âœ… |
| phone | CharField | ç”µè¯ | âœ… |
| contractor | CharField | æ–½å·¥å•ä½ | âœ… |
| contractor_contact | CharField | æ–½å·¥å•ä½è”ç³»äºº | âœ… |
| owner | CharField | ä¸šä¸» | âœ… |
| area | DecimalField | é¢ç§¯ | âœ… |
| construction_cost | DecimalField | å»ºå®‰é€ ä»· | âœ… |
| on_site_records | TextField | ç°åœºå¼€å•è®°å½•æ˜ç»† | âœ… |
| remarks | TextField | å¤‡æ³¨ | âœ… |

### UserProfile (ç”¨æˆ·æ‰©å±•ä¿¡æ¯)

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| user | OneToOneField | å…³è”Djangoç”¨æˆ· |
| is_admin | BooleanField | æ˜¯å¦ä¸ºç®¡ç†å‘˜ |
| created_at | DateTimeField | åˆ›å»ºæ—¶é—´ |

## æ•°æ®åŒæ­¥åŠŸèƒ½

### è‡ªåŠ¨æ•°æ®åŒæ­¥

ç³»ç»Ÿé›†æˆäº†è‡ªåŠ¨æ•°æ®åŒæ­¥åŠŸèƒ½ï¼Œæ¯30åˆ†é’Ÿä»supervisionæ•°æ®åº“åŒæ­¥æœ€æ–°çš„é¡¹ç›®æ•°æ®ï¼š

- **è‡ªåŠ¨å¯åŠ¨**ï¼šæœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡æ•°æ®åŒæ­¥
- **å®šæ—¶åŒæ­¥**ï¼šæ¯30åˆ†é’Ÿè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡æ•°æ®åŒæ­¥
- **å¢é‡æ›´æ–°**ï¼šåªæ›´æ–°å˜åŒ–çš„æ•°æ®ï¼Œä¿ç•™å…¶ä»–å­—æ®µ

### åŒæ­¥å­—æ®µæ˜ å°„

| supervisionæ•°æ®åº“ | table_manageræ•°æ®åº“ | è¯´æ˜ |
|------------------|---------------------|------|
| id | sub_project_id | å­é¡¹ç›®å”¯ä¸€æ ‡è¯† |
| project_name | sub_project | é¡¹ç›®åç§° |
| status | status | é¡¹ç›®çŠ¶æ€ |
| dxmjsdw_name | main_construction_unit | å¤§é¡¹ç›®å»ºè®¾å•ä½ |
| problem_Nums | on_site_records | ç°åœºå¼€å•è®°å½•æ˜ç»† |
| xcd_nums | inspection_details | å·¡æŸ¥æ—¥æœŸæ˜ç»† |
| problem_Nums_completed | rectification_details | æ•´æ”¹å®Œæˆæƒ…å†µæ˜ç»† |

### æ‰‹åŠ¨æ•°æ®åŒæ­¥

ç®¡ç†å‘˜å¯ä»¥æ‰‹åŠ¨æ‰§è¡Œæ•°æ®åŒæ­¥ï¼š

```bash
# ç«‹å³æ‰§è¡Œæ•°æ®åŒæ­¥
python manage.py sync_data

# æµ‹è¯•æ•°æ®åŒæ­¥åŠŸèƒ½
python manage.py test_sync
```

### æ—¥å¿—æ–‡ä»¶

æ•°æ®åŒæ­¥çš„è¯¦ç»†æ—¥å¿—è®°å½•åœ¨ `logs/sync.log` æ–‡ä»¶ä¸­ï¼ŒåŒ…æ‹¬ï¼š
- åŒæ­¥å¼€å§‹å’Œç»“æŸæ—¶é—´
- æ–°å¢å’Œæ›´æ–°çš„è®°å½•æ•°é‡
- é”™è¯¯ä¿¡æ¯å’Œå¼‚å¸¸å¤„ç†

## å®‰å…¨ç‰¹æ€§

- CSRFä¿æŠ¤
- ç”¨æˆ·è®¤è¯å’Œæˆæƒ
- å›¾ç‰‡éªŒè¯ç é˜²æ­¢è‡ªåŠ¨åŒ–æ”»å‡»
- ä¼šè¯ç®¡ç†
- SQLæ³¨å…¥é˜²æŠ¤ï¼ˆDjango ORMï¼‰
- XSSé˜²æŠ¤ï¼ˆæ¨¡æ¿è‡ªåŠ¨è½¬ä¹‰ï¼‰
- æ•°æ®åŒæ­¥å®‰å…¨æ€§ï¼ˆæ•°æ®åº“è¿æ¥åŠ å¯†ï¼‰

## å¼€å‘è¯´æ˜

### é¡¹ç›®ç»“æ„

```
django_table_manager/
â”œâ”€â”€ manage.py                 # Djangoç®¡ç†è„šæœ¬
â”œâ”€â”€ requirements.txt          # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ README.md                # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ table_manager/           # é¡¹ç›®é…ç½®
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ settings.py          # é¡¹ç›®è®¾ç½®
â”‚   â”œâ”€â”€ urls.py              # ä¸»URLé…ç½®
â”‚   â”œâ”€â”€ wsgi.py              # WSGIé…ç½®
â”‚   â””â”€â”€ asgi.py              # ASGIé…ç½®
â”œâ”€â”€ projects/                # ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ admin.py             # ç®¡ç†åå°é…ç½®
â”‚   â”œâ”€â”€ apps.py              # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ models.py            # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ views.py             # è§†å›¾å‡½æ•°
â”‚   â”œâ”€â”€ forms.py             # è¡¨å•å®šä¹‰
â”‚   â”œâ”€â”€ urls.py              # URLè·¯ç”±
â”‚   â””â”€â”€ migrations/          # æ•°æ®åº“è¿ç§»
â””â”€â”€ templates/               # æ¨¡æ¿æ–‡ä»¶
    â”œâ”€â”€ base.html            # åŸºç¡€æ¨¡æ¿
    â””â”€â”€ projects/            # é¡¹ç›®æ¨¡æ¿
        â”œâ”€â”€ login.html       # ç™»å½•é¡µé¢
        â”œâ”€â”€ project_list.html # é¡¹ç›®åˆ—è¡¨
        â”œâ”€â”€ project_detail.html # é¡¹ç›®è¯¦æƒ…
        â”œâ”€â”€ project_edit.html  # é¡¹ç›®ç¼–è¾‘
        â”œâ”€â”€ user_list.html     # ç”¨æˆ·åˆ—è¡¨
        â””â”€â”€ create_user.html   # åˆ›å»ºç”¨æˆ·
```

### è‡ªå®šä¹‰é…ç½®

å¯åœ¨ `settings.py` ä¸­ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š

- `SECRET_KEY`ï¼šç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨å®‰å…¨çš„å¯†é’¥
- `DEBUG`ï¼šç”Ÿäº§ç¯å¢ƒè®¾ä¸º `False`
- `ALLOWED_HOSTS`ï¼šæ·»åŠ å…è®¸çš„åŸŸå
- æ•°æ®åº“è¿æ¥å‚æ•°
- æ—¶åŒºå’Œè¯­è¨€è®¾ç½®

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•é‡ç½®ç®¡ç†å‘˜å¯†ç ï¼Ÿ
A: ä½¿ç”¨ `python manage.py changepassword <username>` å‘½ä»¤

### Q: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ
A: ä½¿ç”¨ `python manage.py dumpdata > backup.json` å¯¼å‡ºæ•°æ®

### Q: éªŒè¯ç çœ‹ä¸æ¸…æ€ä¹ˆåŠï¼Ÿ
A: ç‚¹å‡»éªŒè¯ç å›¾ç‰‡å¯ä»¥åˆ·æ–°

### Q: å¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ
A: è”ç³»ç®¡ç†å‘˜é‡ç½®å¯†ç æˆ–ä½¿ç”¨Djangoç®¡ç†å‘½ä»¤

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤Issueæˆ–è”ç³»å¼€å‘è€…ã€‚ 